# DataBase
* * *
### Transaction

 #### ACID

- Atomicity : 한 트랜잭션 낸 실행한 작업들은 하나의 작업으로 간주한다. 모두 성공 또는 실패되어야 한다.
- Consistency : 모든 트랜잭션은 일관성있는 db상태를 유지한다. 
- Isolation : 동시에 실행되는 트랜잭션들이 서로 영향을 미치지 않도록 격리해야 한다.
- Durability : 트랜잭션을 성공적으로 마치면 그 결과가 항상 저장되어야 한다.
- 이슈 : 격리성을 완벽히 보장하기 위해 트랜잭션을 순차적으로 실행하면 동시성 처리 이슈가 발생한다. 동시성을 높이기 위해 여러 트랜잭션을 병렬처리하게 되면 데이터의 무결성이 깨질 수 있다.

#### Isolation 관련 문제점

- Dirty Read : 한 트랜잭션이 데이터에 접근하여 A를 B로 변경하고 커밋을 하지 않았을 때, 다른 트랜잭션이 해당 데이터를 read하면 B를 읽게 될 것이다. 그런데 커밋하지 않고 종료하면 다른 트랜잭션의 데이터는 꼬인다.
- Non-Repeatable Read : 한 트랜잭션 내에서 같은 쿼리를 수행할 경우, 같은 결과를 반환해야 하는데, 트랜잭션 수행 중 다른 트랜잭션이 값을 수정하는 경우, 다른 결과를 반환하게 된다.
- Phantom Read : 다른 트랜잭션이 추가한 데이터를 읽고 있는데 걔가 롤백하면 나는 귀신을 읽고 있는것.

#### Transaction Isolation Level

 위와 같은 문제들 때문에 ANSI 표준에서 트랜잭션의 격리성과 동시 처리 성능 사이의 Trade-off를 두고 4단계 격리수준을 나누었다. 내려갈수록 격리 수준이 높아져서 격리성은 높아지지만 동시 처리 성능은 떨어진다.

##### Read Uncommitted

 한 트랜잭션에서 커밋하지 않은 데이터에 다른 트랜잭션이 접근할 수 있다. 즉, 커밋하지 않은 데이터를 읽을 수 있다. 이 수준은 위에서 언급한 모든 문제가 발생할 가능성이 있다. 대신 동시 처리 성능은 가장 높다.

##### Read Committed

 커밋이 완료된 데이터만 읽을 수 있다. Dirty Read가 발생할 여지는 없지만 동시 처리 성능은 Read Uncommitted보다 떨어진다. 또한 Non-Repeatable Read와 Phantom Read는 발생 가능하다. db는 보통 Read Committed를 디폴트 수준으로 지정한다.

##### Repeatable Read

 트랜잭션 내에서 한번 조회한 데이터를 반복해서 조회해도 같은 데이터가 조회된다. 트랜잭션이 시작되기 전에 커밋된 내용에 대해서만 조회할 수 있는 격리수준이다. 이는 개별 데이터 이슈인 Dirty Read나 Non-Repeatble Read는 발생하지 않지만, 결과 집합 자체가 달라지는 Phantom Read는 발생가능하다.

##### Serializable

 가장 엄격한 격리 수준. 읽기 작업에도 공유 잠금을 설정한다.